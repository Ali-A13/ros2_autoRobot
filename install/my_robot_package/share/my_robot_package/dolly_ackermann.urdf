<?xml version="1.0" ?>
  <robot name="dolly">
  
  <link name="base">
    <visual>
      <geometry>
          <box size="1.0 0.4 0.1"/>
      </geometry>
      <material name="blue">
        <color rgba="0.0 0.0 2.0 1" />
      </material>
    </visual>
  <inertial>
            <mass value="1" />  
            <inertia ixx="0.0142" ixy="0.0" ixz="0"   
            iyy="0.0842" iyz="0" izz="0.0967" />
    </inertial>
    <collision>src/my_robot_package/launch/gazebo_bringup.launch.py
      <geometry>
          <box size="1.0 0.4 0.1"/> <!-- collision box, same demension as physcial box-->
      </geometry>
      
    </collision>
  </link>
    
<link name="base_footprint"/>     <!-- Is like a shadow on the ground in the exact center, under the base (base_link)
 Its primary purpose is to enable various packages 
 determine the center of a robot projected to the ground.-->
  <joint name="base_joint" type="fixed">
    <parent link="base_footprint"/>
    <child link="base"/>
    <origin rpy="0 0 0" xyz="0 0 0.135"/>
  </joint>

<!-- Front Right Wheel and Front Right Steer bar: Link and Joint-->
  <link name="front_right_wheel_link">
    <inertial>
            <mass value="2" />
            <inertia ixx="0.01" ixy="0.0" ixz="0" 
            iyy="0.01" iyz="0" izz="0.01" />
    </inertial>

    <visual>
      
      <geometry>
          <cylinder radius=".15" length="0.1"/>
      </geometry>
      <material name="orange">
        <color rgba="2 1 0 1"/>
      </material>
    </visual>

    <collision>
    
      <geometry>
          <cylinder radius="0.15" length="0.1"/>
      </geometry>
      <contact_coefficients mu="1" kp="1e+13" kd="1.0"/> <!-- Friction-->
    </collision>
  </link>

  <link name="front_right_bar_link">
    <inertial>
      <origin xyz="0.0 0.0 0.0" rpy="0.0 0.0 0.0"/>   <!-- get inertia-->
      <mass value="0.5"/>
      <inertia ixx="5.4167" ixy="0.0" ixz="0.0" iyy="0.0017" iyz="0.0" izz="0.0017"/>
    </inertial>
    <visual name="">
      <origin xyz="-0.25 0.19 0.055" rpy="0.0 0.0 0.0"/>
      <geometry>
        <box size="0.2 0.03 0.02"/>
      </geometry>
      <material name="Red">
        <color rgba="1.0 0.0 0.0 1.0"/>
        <texture filename=""/>
      </material>
    </visual>
    <collision>
      <origin xyz="-0.25 0.19 0.055" rpy="0.0 0.0 0.0"/>
      <geometry>
        <box size="0.2 0.03 0.02"/>
      </geometry>
    </collision>
  </link>

  <joint name="front_right_wheel_joint" type="continuous">
    <origin xyz="-0.35 0.25 0.135" rpy="1.57 0.0 0.0"/>
    <parent link="front_right_bar_link"/>
    <child link="front_right_wheel_link"/>
    <axis xyz="0.0 0.0 1.0"/>
  </joint>

  <joint name="front_right_bar_joint" type="revolute">
    <origin xyz="0.0 0.0 -0.135" rpy="0.0 0.0 0.0"/>
    <parent link="base"/>
    <child link="front_right_bar_link"/>
    <axis xyz="0.0 0.0 1.0"/>
    <limit lower="-0.3499" upper="+0.5236" velocity="3.0" effort="0.88269"/>
  </joint>

<!-- Front Left Wheel and Front Left Steer bar: Link and Joint-->

    <link name="front_left_wheel_link">
    <inertial>
            <mass value="2" />
            <inertia ixx="0.01" ixy="0.0" ixz="0" 
            iyy="0.01" iyz="0" izz="0.01" />
    </inertial>

    <visual>
      
      <geometry>
          <cylinder radius=".15" length="0.1"/>
      </geometry>
      <material name="orange">
        <color rgba="2 1 0 1"/>
      </material>
    </visual>

    <collision>
    
      <geometry>
          <cylinder radius="0.15" length="0.1"/>
      </geometry>
      <contact_coefficients mu="1" kp="1e+13" kd="1.0"/> <!-- Friction-->
    </collision>
  </link>

  <link name="front_left_bar_link">
    <inertial>
      <origin xyz="0.0 0.0 0.0" rpy="0.0 0.0 0.0"/>   <!-- get inertia-->
      <mass value="0.5"/>
      <inertia ixx="5.4167" ixy="0.0" ixz="0.0" iyy="0.0017" iyz="0.0" izz="0.0017"/>
    </inertial>
    <visual name="">
      <origin xyz="-0.25 -0.19 0.055" rpy="0.0 0.0 0.0"/>
      <geometry>
        <box size="0.2 0.03 0.02"/>
      </geometry>
      <material name="Red">
        <color rgba="1.0 0.0 0.0 1.0"/>
        <texture filename=""/>
      </material>
    </visual>
    <collision>
      <origin xyz="-0.25 0.19 0.055" rpy="0.0 0.0 0.0"/>
      <geometry>
        <box size="0.2 0.03 0.02"/>
      </geometry>
    </collision>
  </link>

  <joint name="front_left_wheel_joint" type="continuous">
    <origin xyz="-0.35 -0.25 0.135" rpy="1.57 0.0 0.0"/>
    <parent link="front_left_bar_link"/>
    <child link="front_left_wheel_link"/>
    <axis xyz="0.0 0.0 1.0"/>
  </joint>

  <joint name="front_left_bar_joint" type="revolute">
    <origin xyz="0.0 0.0 -0.135" rpy="0.0 0.0 0.0"/>
    <parent link="base"/>
    <child link="front_left_bar_link"/>
    <axis xyz="0.0 0.0 1.0"/>
    <limit lower="-0.3499" upper="+0.5236" velocity="3.0" effort="0.88269"/>
  </joint>

<!-- Ackermann Bar Steering-->

    <link name="ackermann_bar">
      <inertial>
        <mass value="1.0" />
        <origin xyz="0 0 0" /> 
        <inertia  ixx="1.0" ixy="0.0"  ixz="0.0"  iyy="1.0"  iyz="0.0"  izz="1.0" />
      </inertial>
      <visual>
        <origin xyz="-0.05 -0.3 0" rpy="0 0 0" />
        <geometry>
          <box size="0.04 0.4 0.01" />
        </geometry>
      </visual>
      <collision>
        <origin xyz="-0.05 -0.3 0" rpy="0 0 0" />
        <geometry>
          <box size="0.04 0.4 0.01" />
        </geometry>
      </collision>
    </link>
    <gazebo reference="ackermann_bar">
      <material>Gazebo/Green</material>
      <turnGravityOff>false</turnGravityOff>
    </gazebo>
    <joint name="ackermann_bar_joint" type="continuous" >
      <axis xyz="0 0 1" />
      <parent link="front_left_bar_link" />
      <child link="ackermann_bar" />
      <origin xyz="-0.1 0.3 0.05" rpy="0 0 0" />
    </joint>

    <gazebo>
      <joint name="ackermann_bar_loop_joint" type="continuous">
        <parent link="front_right_link_bar"/>
        <child link="ackermann_bar"/>
        <axis xyz="0.0 0.0 1.0"/>
        <origin xyz="-0.4 0.2 0.0" rpy="0.0 0.0 0.0"/>
      </joint>
    </gazebo>


<!-- Rear Wheel Links and Joints-->

  <link name="back_right_wheel_link">
    <inertial>
            <mass value="2" />
            <inertia ixx="0.01" ixy="0.0" ixz="0" 
            iyy="0.01" iyz="0" izz="0.01" />
    </inertial>

    <visual>
      
      <geometry>
          <cylinder radius=".15" length="0.1"/>
      </geometry>
      <material name="orange">
        <color rgba="2 1 0 1"/>
      </material>
    </visual>

    <collision>
    
      <geometry>
          <cylinder radius="0.15" length="0.1"/>
      </geometry>
      <contact_coefficients mu="1" kp="1e+13" kd="1.0"/> <!-- Friction-->
    </collision>
  </link>

  <joint name="back_right_wheel_joint" type="continuous">
    <origin xyz="0.35 0.25 0.0" rpy="1.57 0.0 0.0"/> <!-- pi/2 = 1.57-->
    <parent link="base"/>
    <child link="back_right_wheel_link"/>
    <axis xyz="0.0 0.0 1.0"/> <!-- It specifies the direction around which the joint rotates.-->
  </joint>

  <link name="back_left_wheel_link">
    <inertial>
            <mass value="2" />
            <inertia ixx="0.01" ixy="0.0" ixz="0" 
            iyy="0.01" iyz="0" izz="0.01" />
    </inertial>

    <visual>
      
      <geometry>
          <cylinder radius="0.15" length="0.1"/>
      </geometry>
      <material name="orange">
        <color rgba="2 1 0 1"/>
      </material>
    </visual>

    <collision>
      <geometry>
          <cylinder radius="0.15" length="0.1"/>
      </geometry>
      <contact_coefficients mu="1" kp="1e+13" kd="1.0"/>
    </collision>
  </link>

  <joint name="back_left_wheel_joint" type="continuous">
    <origin xyz="0.35 -0.25 0.0" rpy="1.57 0.0 0.0"/> <!-- pi/2=1.57-->
    <parent link="base"/>
    <child link="back_left_wheel_link"/>
    <axis xyz="0.0 0.0 1.0"/> <!-- It specifies the direction around which the joint rotates.-->

  </joint>


<!-- 

  <link name="caster">
    <inertial>
            <mass value="1" />
            <inertia ixx="0.01" ixy="0.0" ixz="0" 
            iyy="0.01" iyz="0" izz="0.01" />
    </inertial>

    <visual>
    
      <geometry>
        <sphere radius=".08" />
      </geometry>
      <material name="white" />
    </visual>

    <collision>
      <origin/>
      <geometry>
        <sphere radius=".08" />
      </geometry>
    </collision>
  </link>

  <joint name="caster_joint" type="continuous">
    <origin xyz="-0.3 0.0 -0.07" rpy="0.0 0.0 0.0"/>
    <axis xyz="0 0 1" />
    <parent link="base"/>
    <child link="caster"/>
  </joint>

  -->
  
  <link name="camera">
    <inertial>
            <mass value="0.1" />
            <inertia ixx="0.01" ixy="0.0" ixz="0" 
            iyy="0.01" iyz="0" izz="0.01" />
    </inertial>

    <visual>
      
      <geometry>
        <box size="0.1 0.1 0.05"/>
      </geometry>
      <material name="green">
        <color rgba="0 1 0 1"/>
      </material>
    </visual>

    <collision>
      <geometry>
          <box size="0.1 0.1 0.05"/>
      </geometry>
    </collision>
  </link>

  <joint name="camera_joint" type="fixed">
    <origin xyz="-0.35 0 0.01" rpy="0 0.0 3.14"/>
    <parent link="base"/>
    <child link="camera"/>
    <axis xyz="0.0 0.0 1.0"/>

  </joint>

  <link name="lidar">
    <inertial>
            <mass value="0.5" />
            <inertia ixx="0.01" ixy="0.0" ixz="0" 
            iyy="0.01" iyz="0" izz="0.01" />
    </inertial>

    <visual>
      
      <geometry>
        <cylinder radius="0.1" length="0.05"/>
      </geometry>
      <material name="yellow">
        <color rgba="1 1 0 1"/>
      </material>
    </visual>

    <collision>
      <geometry>
          <box size="0.1 0.1 0.1"/>
      </geometry>
    </collision>
  </link>

  <joint name="lidar_joint" type="fixed">
    <origin xyz="-0.285 0 0.075" rpy="0 0.0 1.57"/>
    <parent link="base"/>
    <child link="lidar"/>
    <axis xyz="0.0 0.0 1.0"/>

  </joint>

<link name="imu_link">
  
</link>
<joint name="imu_joint" type="fixed">
  <parent link="base"/>
  <child link="imu_link"/>
</joint>
<!-- Gazebo colors to links as upper defined colors are only visible in RVIZ-->
<gazebo reference="base">
  <material>Gazebo/Blue</material>
</gazebo>

<!--
<gazebo reference="caster">
  <material>Gazebo/White</material>
</gazebo>
-->
<gazebo reference="front_right_bar_link">
  <material>Gazebo/Red</material>
</gazebo>

<gazebo reference="front_left_bar_link">
  <material>Gazebo/Red</material>
</gazebo>

<gazebo reference="front_right_wheel_link">
  <material>Gazebo/Orange</material>
</gazebo>
<gazebo reference="front_left_wheel_link">
  <material>Gazebo/Orange</material>
</gazebo> 

<gazebo reference="back_right_wheel_link">
  <material>Gazebo/Orange</material>
</gazebo>
<gazebo reference="back_left_wheel_link">
  <material>Gazebo/Orange</material>
</gazebo> 
<!-- DIFFENERNTIAL DRIVEEEEEEEEEEEEE -->
<!-- you can simulate differential drive robots in Gazebo and control them using ROS topics or services.-->


<!-- Gazebo Plugins -->
    
  <gazebo>
    <plugin filename="libignition-gazebo-ackermann-steering-system.so"
              name="ignition::gazebo::systems::AckermannSteering">
      <left_steering_joint>front_left_bar_joint</left_steering_joint>
      <left_joint>back_left_wheel_joint</left_joint>

      <right_steering_joint>front_right_bar_joint</right_steering_joint>
      <right_joint>back_right_wheel_joint</right_joint>

      <wheel_separation>0.5</wheel_separation>
      <wheel_radius>0.3</wheel_radius>
      <odom_publish_frequency>20</odom_publish_frequency>

      <min_velocity>-13</min_velocity>
      <max_velocity>13</max_velocity>
      <min_acceleration>-5</min_acceleration>
      <max_acceleration>5</max_acceleration>

      <topic>/cmd_vel</topic>
      <frame_id>odom</frame_id>
      <child_frame_id>base_footprint</child_frame_id>
    </plugin>
  </gazebo> 
    

<!-- 
  <gazebo>
    <plugin filename="libgazebo_ros_diff_drive.so" name="gazebo_base_controller">
      <odometry_frame>odom</odometry_frame>
      <commandTopic>cmd_vel</commandTopic>
      <publish_odom>true</publish_odom>
      <publish_odom_tf>true</publish_odom_tf>
      <update_rate>15.0</update_rate>

      <left_joint>front_left_wheel_joint</left_joint>
      <right_joint>front_right_wheel_joint</right_joint>

      <left_joint>back_left_wheel_joint</left_joint>
      <right_joint>back_right_wheel_joint</right_joint>
 
      <wheel_separation>0.5</wheel_separation>  From one wheel to another
      <wheel_diameter>0.3</wheel_diameter>
      <max_wheel_acceleration>0.7</max_wheel_acceleration>
      <max_wheel_torque>8</max_wheel_torque>
      <robotBaseFrame></robotBaseFrame>
    </plugin>
  </gazebo>

  <gazebo>
    <plugin name="skid_steer_drive_controller" filename="libgazebo_ros_diff_drive.so">
      <updateRate>15.0</updateRate>
      <publish_odom>true</publish_odom>
      <publish_odom_tf>true</publish_odom_tf>
      <robotNamespace>/</robotNamespace>
      <leftFrontJoint>front_left_wheel_joint</leftFrontJoint>
      <rightFrontJoint>front_right_wheel_joint</rightFrontJoint>
      <leftRearJoint>back_left_wheel_joint</leftRearJoint>
      <rightRearJoint>back_right_wheel_joint</rightRearJoint>
      <wheelSeparation>0.5</wheelSeparation>
      <wheelDiameter>0.3</wheelDiameter>
      <robotBaseFrame></robotBaseFrame>
      <torque>8</torque>
      <topicName>cmd_vel</topicName>
      <broadcastTF>false</broadcastTF>
    </plugin>
  </gazebo>
 -->

<!-- CAMERAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA -->
      <gazebo reference="camera">
    <sensor type="camera" name="camera1">
      <update_rate>30.0</update_rate>
      <camera name="head">
        <horizontal_fov>1.3962634</horizontal_fov>
        <image>
          <width>800</width>
          <height>800</height>
          <format>R8G8B8</format>
        </image>
        <clip>
          <near>0.02</near>
          <far>300</far>
        </clip>
      </camera>
      <plugin name="camera_controller" filename="libgazebo_ros_camera.so">
        <alwaysOn>true</alwaysOn>
        <updateRate>0.0</updateRate>
        <cameraName>/camera</cameraName>
        <imageTopicName>image_raw</imageTopicName>
        <cameraInfoTopicName>camera_info</cameraInfoTopicName>
        <frameName>camera_link</frameName>
        <hackBaseline>0.07</hackBaseline>
      </plugin>
    </sensor>
    <material>Gazebo/Green</material>
  </gazebo>
  
<!-- LIDAAAAAAAAAAAAAAAAAAAAAAAAAAR -->
   <gazebo reference="lidar">
    <sensor name="gazebo_lidar" type="ray">
     <visualize>true</visualize>
      <update_rate>12.0</update_rate>
      <plugin filename="libgazebo_ros_ray_sensor.so" name="gazebo_lidar">
      <ros>
        <remapping>~/out:=scan</remapping>
      </ros>
      
      <output_type>sensor_msgs/LaserScan</output_type>    <!-- Outputs data to LaserScan topic-->
      <frame_name>lidar</frame_name>   <!-- lidar link from above ^-->
      </plugin>
      <ray>
        <scan>
          <horizontal>
            <samples>360</samples>
            <resolution>1</resolution>
            <min_angle>0.00</min_angle>
            <max_angle>3.14</max_angle>
          </horizontal>
        </scan>
        <range>
          <min>0.120</min>
          <max>3.5</max>
          <resolution>0.015</resolution>
        </range>
        
      </ray>
    </sensor>
    <material>Gazebo/Yellow</material>
  </gazebo>


<!-- imuuuuuuuuuuuuuuuu -->

<gazebo reference="imu_link">
    <gravity>true</gravity>
    <sensor name="imu_sensor" type="imu">
      <always_on>true</always_on>
      <update_rate>100</update_rate>
      <visualize>true</visualize>
      <plugin filename="libgazebo_ros_imu_sensor.so" name="imu_plugin">
        <ros>
            <remapping>~/out:=imu</remapping>
          </ros>
        <topicName>imu</topicName>
        <bodyName>imu_link</bodyName>
        <updateRateHZ>10.0</updateRateHZ>
        <xyzOffset>0 0 0</xyzOffset>
        <rpyOffset>0 0 0</rpyOffset>
        <frameName>imu_link</frameName>
        <initialOrientationAsReference>false</initialOrientationAsReference>
      </plugin>
      <pose>0 0 0 0 0 0</pose>
    </sensor>
  </gazebo>
</robot>